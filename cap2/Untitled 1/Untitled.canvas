{
	"nodes":[
		{"id":"f0546a5c48399170","type":"text","text":"using UnityEngine;\nusing TMPro;\n\n[RequireComponent(typeof(Collider2D))] // Requires a Collider2D component on this GameObject\npublic class HitScore2D : MonoBehaviour\n{\n    // Header for Inspector organization\n    [Header(\"References\")]\n    public GloveController2D gloveController; // Reference to the GloveController2D script\n    public TextMeshProUGUI scoreText;         // Reference to the TextMeshProUGUI for displaying score\n\n    [Header(\"Sandbag Spawning\")]\n    public GameObject sandbagPrefab;           // Prefab of the sandbag to be spawned\n    public Vector2 spawnPosition = Vector2.zero; // World position where new sandbags will spawn\n    public Transform sandbagParent;             // Parent Transform for spawned sandbags (for hierarchy organization)\n\n    [Header(\"Feedback\")]\n    public GameObject hitEffectPrefab;         // Prefab for visual hit effect\n    public AudioClip hitSound;                // Audio clip to play on hit\n\n    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ internals â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n    private AudioSource audioSrc;             // Reference to the AudioSource component\n    private int score;                        // Current game score\n    private bool resultLoaded;                // Flag to prevent multiple result scene transitions\n\n    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n    void Awake()\n    {\n        // Get or add an AudioSource component\n        audioSrc = GetComponent<AudioSource>();\n        if (audioSrc == null) audioSrc = gameObject.AddComponent<AudioSource>();\n    }\n\n    // Called when this object's non-trigger collider begins touching another non-trigger 2D collider.\n    // This function enables physical interactions like repulsion.\n    void OnCollisionEnter2D(Collision2D collision) // Changed from Collider2D to Collision2D\n    {\n        // Check if the collided object has the \"Sandbag\" tag and if the result scene hasn't loaded yet\n        if (!collision.gameObject.CompareTag(\"Sandbag\") || resultLoaded) return; // Access GameObject via collision.gameObject\n\n        // ðŸ”´ðŸ”´ðŸ”´ IMPORTANT: Removed HideAndDestroy(collision.gameObject) ðŸ”´ðŸ”´ðŸ”´\n        // If you want the sandbag to physically bounce, it should not be hidden/destroyed immediately.\n\n        /* 1) Calculate and update score */\n        int gain = Mathf.RoundToInt(gloveController.GetCurrentSpeed()); // Get score based on glove speed\n        score += gain;                                                 // Add gain to total score\n        if (scoreText) scoreText.text = $\"Score: {score}\";             // Update score display\n\n        /* 2) Play effects */\n        if (hitEffectPrefab)\n            // Using collision.contacts[0].point for more accurate hit effect position\n            // If you only want the center of the sandbag, use collision.transform.position\n            Instantiate(hitEffectPrefab, collision.contacts[0].point, Quaternion.identity);\n        if (hitSound)\n            audioSrc.PlayOneShot(hitSound); // Play hit sound once\n\n        /* 3) Spawn next sandbag */\n        // This block might be unnecessary if the game immediately transitions to a result scene after one hit.\n        // If (sandbagPrefab)\n        //     Instantiate(sandbagPrefab, spawnPosition, Quaternion.identity, sandbagParent);\n\n        /* 4) Reset glove state */\n        gloveController.StartReset(); // Tell the glove controller to reset\n\n        /* 5) Transition to result scene */\n        GameManager.Instance.StartResultTransition(score); // Trigger scene transition with current score\n        resultLoaded = true;                               // Set flag to prevent further transitions\n    }\n\n    /* Public getter for the current score */\n    public int Score => score;\n\n    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n    // This helper function is no longer called in OnCollisionEnter2D.\n    // It can be removed if it's not used elsewhere.\n    void HideAndDestroy(GameObject go)\n    {\n        foreach (var sr in go.GetComponentsInChildren<SpriteRenderer>())\n            sr.enabled = false;\n        foreach (var c in go.GetComponentsInChildren<Collider2D>())\n            c.enabled = false;\n\n        Destroy(go, 0.05f); \n    }\n}","x":-125,"y":-30,"width":250,"height":60},
		{"id":"69a501ac4d76957f","x":-1790,"y":-1880,"width":1750,"height":480,"type":"file","file":"Pasted image 20250620155326.png"},
		{"id":"f71c51a985648cc4","x":80,"y":-1910,"width":1799,"height":540,"type":"file","file":"Pasted image 20250620155342.png"}
	],
	"edges":[]
}